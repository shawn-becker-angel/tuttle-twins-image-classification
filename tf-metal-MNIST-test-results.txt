/Users/sbecker11/workspace-angel/tuttle-twins-image-classification
> /usr/bin/env /Users/sbecker11/workspace-angel/tuttle-twins-image-classification/venv-tf-metal/bin/python /Users/sbecker11/.vscode/extensions/ms-python.python-2022.6.2/pythonFiles/lib/python/debugpy/launcher 62950 -- /Users/sbecker11/workspace-angel/tuttle-twins-image-classification/tf-metal-test.py 
Metal device set to: AMD Radeon Pro Vega 20

systemMemory: 32.00 GB
maxCacheSize: 1.99 GB

2022-05-24 02:03:30.154986: I tensorflow/core/common_runtime/pluggable_device/pluggable_device_factory.cc:305] Could not identify NUMA node of platform GPU ID 0, defaulting to 0. Your kernel may not have been built with NUMA support.
2022-05-24 02:03:30.155384: I tensorflow/core/common_runtime/pluggable_device/pluggable_device_factory.cc:271] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 0 MB memory) -> physical PluggableDevice (device: 0, name: METAL, pci bus id: <undefined>)
a: tf.Tensor([1.063613  0.4413555], shape=(2,), dtype=float32)
b: tf.Tensor([1.063613  0.4413555], shape=(2,), dtype=float32)

download the mnist dataset

create and compile model

now fit model to ds_train and ds_test
Epoch 1/100
2022-05-24 02:05:12.480072: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.
938/938 [==============================] - ETA: 0s - loss: 0.1969 - accuracy: 0.93832022-05-24 02:05:32.348082: I tensorflow/core/grappler/optimizers/custom_graph_optimizer_registry.cc:113] Plugin optimizer for device_type GPU is enabled.
938/938 [==============================] - 23s 20ms/step - loss: 0.1969 - accuracy: 0.9383 - val_loss: 0.0982 - val_accuracy: 0.9689
Epoch 2/100
938/938 [==============================] - 18s 19ms/step - loss: 0.0533 - accuracy: 0.9830 - val_loss: 0.0344 - val_accuracy: 0.9885
Epoch 3/100
938/938 [==============================] - 18s 19ms/step - loss: 0.0358 - accuracy: 0.9887 - val_loss: 0.0437 - val_accuracy: 0.9861
Epoch 4/100
938/938 [==============================] - 18s 19ms/step - loss: 0.0272 - accuracy: 0.9912 - val_loss: 0.0258 - val_accuracy: 0.9924
Epoch 5/100
938/938 [==============================] - 18s 19ms/step - loss: 0.0223 - accuracy: 0.9929 - val_loss: 0.0351 - val_accuracy: 0.9892
Epoch 6/100
938/938 [==============================] - 18s 19ms/step - loss: 0.0183 - accuracy: 0.9943 - val_loss: 0.0335 - val_accuracy: 0.9901
Epoch 7/100
938/938 [==============================] - 18s 19ms/step - loss: 0.0155 - accuracy: 0.9955 - val_loss: 0.0422 - val_accuracy: 0.9891
Epoch 8/100
938/938 [==============================] - 18s 19ms/step - loss: 0.0124 - accuracy: 0.9960 - val_loss: 0.0356 - val_accuracy: 0.9908
Epoch 9/100
938/938 [==============================] - 18s 19ms/step - loss: 0.0105 - accuracy: 0.9968 - val_loss: 0.0410 - val_accuracy: 0.9892
Epoch 10/100
938/938 [==============================] - 18s 19ms/step - loss: 0.0090 - accuracy: 0.9970 - val_loss: 0.0427 - val_accuracy: 0.9916
Epoch 11/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0085 - accuracy: 0.9975 - val_loss: 0.0369 - val_accuracy: 0.9904
Epoch 12/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0067 - accuracy: 0.9979 - val_loss: 0.0525 - val_accuracy: 0.9903
Epoch 13/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0061 - accuracy: 0.9981 - val_loss: 0.0539 - val_accuracy: 0.9917
Epoch 14/100
938/938 [==============================] - 18s 19ms/step - loss: 0.0060 - accuracy: 0.9981 - val_loss: 0.0481 - val_accuracy: 0.9914
Epoch 15/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0056 - accuracy: 0.9983 - val_loss: 0.0482 - val_accuracy: 0.9904
Epoch 16/100
938/938 [==============================] - 19s 21ms/step - loss: 0.0055 - accuracy: 0.9985 - val_loss: 0.0721 - val_accuracy: 0.9892
Epoch 17/100
938/938 [==============================] - 19s 21ms/step - loss: 0.0043 - accuracy: 0.9988 - val_loss: 0.0692 - val_accuracy: 0.9917
Epoch 18/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0039 - accuracy: 0.9988 - val_loss: 0.0614 - val_accuracy: 0.9923
Epoch 19/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0032 - accuracy: 0.9992 - val_loss: 0.0599 - val_accuracy: 0.9899
Epoch 20/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0032 - accuracy: 0.9989 - val_loss: 0.0617 - val_accuracy: 0.9920
Epoch 21/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0031 - accuracy: 0.9991 - val_loss: 0.0649 - val_accuracy: 0.9914
Epoch 22/100
938/938 [==============================] - 19s 21ms/step - loss: 0.0037 - accuracy: 0.9988 - val_loss: 0.0717 - val_accuracy: 0.9914
Epoch 23/100
938/938 [==============================] - 20s 21ms/step - loss: 0.0027 - accuracy: 0.9992 - val_loss: 0.0783 - val_accuracy: 0.9899
Epoch 24/100
938/938 [==============================] - 20s 21ms/step - loss: 0.0033 - accuracy: 0.9991 - val_loss: 0.0724 - val_accuracy: 0.9920
Epoch 25/100
938/938 [==============================] - 19s 21ms/step - loss: 0.0025 - accuracy: 0.9993 - val_loss: 0.0912 - val_accuracy: 0.9908
Epoch 26/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0040 - accuracy: 0.9990 - val_loss: 0.0705 - val_accuracy: 0.9922
Epoch 27/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0042 - accuracy: 0.9990 - val_loss: 0.0807 - val_accuracy: 0.9909
Epoch 28/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0025 - accuracy: 0.9995 - val_loss: 0.0831 - val_accuracy: 0.9917
Epoch 29/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0018 - accuracy: 0.9994 - val_loss: 0.0714 - val_accuracy: 0.9926
Epoch 30/100
938/938 [==============================] - 18s 19ms/step - loss: 0.0027 - accuracy: 0.9992 - val_loss: 0.1017 - val_accuracy: 0.9897
Epoch 31/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0024 - accuracy: 0.9994 - val_loss: 0.0845 - val_accuracy: 0.9924
Epoch 32/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0022 - accuracy: 0.9994 - val_loss: 0.0882 - val_accuracy: 0.9929
Epoch 33/100
938/938 [==============================] - 18s 20ms/step - loss: 0.0023 - accuracy: 0.9995 - val_loss: 0.0954 - val_accuracy: 0.9925
Epoch 34/100
938/938 [==============================] - 18s 20ms/step - loss: 0.0024 - accuracy: 0.9995 - val_loss: 0.1025 - val_accuracy: 0.9914
Epoch 35/100
938/938 [==============================] - 18s 19ms/step - loss: 0.0024 - accuracy: 0.9994 - val_loss: 0.0978 - val_accuracy: 0.9914
Epoch 36/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0025 - accuracy: 0.9994 - val_loss: 0.1049 - val_accuracy: 0.9906
Epoch 37/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0029 - accuracy: 0.9992 - val_loss: 0.1004 - val_accuracy: 0.9916
Epoch 38/100
938/938 [==============================] - 19s 21ms/step - loss: 0.0026 - accuracy: 0.9993 - val_loss: 0.1114 - val_accuracy: 0.9908
Epoch 39/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0023 - accuracy: 0.9995 - val_loss: 0.1053 - val_accuracy: 0.9916
Epoch 40/100
938/938 [==============================] - 18s 20ms/step - loss: 0.0026 - accuracy: 0.9994 - val_loss: 0.0976 - val_accuracy: 0.9922
Epoch 41/100
938/938 [==============================] - 18s 19ms/step - loss: 0.0018 - accuracy: 0.9996 - val_loss: 0.0974 - val_accuracy: 0.9918
Epoch 42/100
938/938 [==============================] - 18s 20ms/step - loss: 0.0018 - accuracy: 0.9996 - val_loss: 0.1062 - val_accuracy: 0.9936
Epoch 43/100
938/938 [==============================] - 18s 20ms/step - loss: 0.0027 - accuracy: 0.9996 - val_loss: 0.1287 - val_accuracy: 0.9911
Epoch 44/100
938/938 [==============================] - 18s 20ms/step - loss: 0.0019 - accuracy: 0.9997 - val_loss: 0.1084 - val_accuracy: 0.9923
Epoch 45/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0036 - accuracy: 0.9994 - val_loss: 0.0985 - val_accuracy: 0.9926
Epoch 46/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0023 - accuracy: 0.9995 - val_loss: 0.1184 - val_accuracy: 0.9909
Epoch 47/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0021 - accuracy: 0.9994 - val_loss: 0.1556 - val_accuracy: 0.9899
Epoch 48/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0019 - accuracy: 0.9997 - val_loss: 0.1355 - val_accuracy: 0.9913
Epoch 49/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0024 - accuracy: 0.9996 - val_loss: 0.1177 - val_accuracy: 0.9919
Epoch 50/100
938/938 [==============================] - 20s 21ms/step - loss: 0.0024 - accuracy: 0.9995 - val_loss: 0.1541 - val_accuracy: 0.9906
Epoch 51/100
938/938 [==============================] - 20s 21ms/step - loss: 0.0023 - accuracy: 0.9995 - val_loss: 0.1452 - val_accuracy: 0.9924
Epoch 52/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0024 - accuracy: 0.9995 - val_loss: 0.1673 - val_accuracy: 0.9915
Epoch 53/100
938/938 [==============================] - 20s 22ms/step - loss: 0.0027 - accuracy: 0.9994 - val_loss: 0.1490 - val_accuracy: 0.9913
Epoch 54/100
938/938 [==============================] - 20s 21ms/step - loss: 0.0021 - accuracy: 0.9997 - val_loss: 0.1350 - val_accuracy: 0.9909
Epoch 55/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0024 - accuracy: 0.9995 - val_loss: 0.1576 - val_accuracy: 0.9904
Epoch 56/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0022 - accuracy: 0.9995 - val_loss: 0.1711 - val_accuracy: 0.9898
Epoch 57/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0020 - accuracy: 0.9997 - val_loss: 0.1820 - val_accuracy: 0.9905
Epoch 58/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0022 - accuracy: 0.9996 - val_loss: 0.1465 - val_accuracy: 0.9916
Epoch 59/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0025 - accuracy: 0.9995 - val_loss: 0.1564 - val_accuracy: 0.9920
Epoch 60/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0017 - accuracy: 0.9997 - val_loss: 0.1485 - val_accuracy: 0.9919
Epoch 61/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0015 - accuracy: 0.9997 - val_loss: 0.1581 - val_accuracy: 0.9927
Epoch 62/100
938/938 [==============================] - 19s 21ms/step - loss: 0.0031 - accuracy: 0.9995 - val_loss: 0.1450 - val_accuracy: 0.9919
Epoch 63/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0033 - accuracy: 0.9995 - val_loss: 0.1714 - val_accuracy: 0.9904
Epoch 64/100
938/938 [==============================] - 18s 20ms/step - loss: 0.0018 - accuracy: 0.9996 - val_loss: 0.1496 - val_accuracy: 0.9918
Epoch 65/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0020 - accuracy: 0.9996 - val_loss: 0.2071 - val_accuracy: 0.9920
Epoch 66/100
938/938 [==============================] - 18s 19ms/step - loss: 0.0013 - accuracy: 0.9998 - val_loss: 0.1469 - val_accuracy: 0.9915
Epoch 67/100
938/938 [==============================] - 18s 19ms/step - loss: 0.0010 - accuracy: 0.9998 - val_loss: 0.1555 - val_accuracy: 0.9924
Epoch 68/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0016 - accuracy: 0.9997 - val_loss: 0.1842 - val_accuracy: 0.9913
Epoch 69/100
938/938 [==============================] - 19s 21ms/step - loss: 0.0027 - accuracy: 0.9997 - val_loss: 0.2037 - val_accuracy: 0.9894
Epoch 70/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0012 - accuracy: 0.9998 - val_loss: 0.1413 - val_accuracy: 0.9932
Epoch 71/100
938/938 [==============================] - 19s 20ms/step - loss: 0.0021 - accuracy: 0.9997 - val_loss: 0.1848 - val_accuracy: 0.9912
Epoch 72/100
938/938 [==============================] - 18s 20ms/step - loss: 0.0024 - accuracy: 0.9995 - val_loss: 0.1852 - val_accuracy: 0.9910
Epoch 73/100
938/938 [==============================] - 18s 19ms/step - loss: 0.0016 - accuracy: 0.9998 - val_loss: 0.1586 - val_accuracy: 0.9913
Epoch 74/100
938/938 [==============================] - 20s 21ms/step - loss: 0.0019 - accuracy: 0.9997 - val_loss: 0.1741 - val_accuracy: 0.9927
Epoch 75/100
938/938 [==============================] - 23s 24ms/step - loss: 0.0017 - accuracy: 0.9997 - val_loss: 0.1966 - val_accuracy: 0.9922
Epoch 76/100
938/938 [==============================] - 24s 25ms/step - loss: 0.0020 - accuracy: 0.9997 - val_loss: 0.1783 - val_accuracy: 0.9920
Epoch 77/100
938/938 [==============================] - 25s 26ms/step - loss: 0.0021 - accuracy: 0.9997 - val_loss: 0.1861 - val_accuracy: 0.9906
Epoch 78/100
938/938 [==============================] - 24s 26ms/step - loss: 0.0016 - accuracy: 0.9998 - val_loss: 0.1562 - val_accuracy: 0.9920
Epoch 79/100
938/938 [==============================] - 24s 26ms/step - loss: 0.0029 - accuracy: 0.9997 - val_loss: 0.1678 - val_accuracy: 0.9914
Epoch 80/100
938/938 [==============================] - 25s 26ms/step - loss: 0.0019 - accuracy: 0.9997 - val_loss: 0.1871 - val_accuracy: 0.9901
Epoch 81/100
938/938 [==============================] - 25s 26ms/step - loss: 0.0024 - accuracy: 0.9997 - val_loss: 0.1994 - val_accuracy: 0.9925
Epoch 82/100
938/938 [==============================] - 25s 26ms/step - loss: 0.0020 - accuracy: 0.9996 - val_loss: 0.1941 - val_accuracy: 0.9911
Epoch 83/100
938/938 [==============================] - 25s 26ms/step - loss: 0.0016 - accuracy: 0.9998 - val_loss: 0.1686 - val_accuracy: 0.9923
Epoch 84/100
938/938 [==============================] - 25s 27ms/step - loss: 9.2055e-04 - accuracy: 0.9998 - val_loss: 0.2062 - val_accuracy: 0.9917
Epoch 85/100
938/938 [==============================] - 25s 26ms/step - loss: 0.0023 - accuracy: 0.9997 - val_loss: 0.2130 - val_accuracy: 0.9907
Epoch 86/100
938/938 [==============================] - 25s 26ms/step - loss: 0.0010 - accuracy: 0.9998 - val_loss: 0.1864 - val_accuracy: 0.9917
Epoch 87/100
938/938 [==============================] - 24s 26ms/step - loss: 0.0022 - accuracy: 0.9997 - val_loss: 0.1849 - val_accuracy: 0.9923
Epoch 88/100
938/938 [==============================] - 24s 26ms/step - loss: 0.0017 - accuracy: 0.9998 - val_loss: 0.1649 - val_accuracy: 0.9920
Epoch 89/100
938/938 [==============================] - 24s 26ms/step - loss: 0.0013 - accuracy: 0.9998 - val_loss: 0.2039 - val_accuracy: 0.9912
Epoch 90/100
938/938 [==============================] - 24s 26ms/step - loss: 0.0013 - accuracy: 0.9998 - val_loss: 0.1720 - val_accuracy: 0.9923
Epoch 91/100
938/938 [==============================] - 23s 25ms/step - loss: 2.7556e-04 - accuracy: 0.9999 - val_loss: 0.1908 - val_accuracy: 0.9926
Epoch 92/100
938/938 [==============================] - 23s 25ms/step - loss: 0.0012 - accuracy: 0.9998 - val_loss: 0.2145 - val_accuracy: 0.9911
Epoch 93/100
938/938 [==============================] - 24s 25ms/step - loss: 0.0010 - accuracy: 0.9999 - val_loss: 0.1749 - val_accuracy: 0.9932
Epoch 94/100
938/938 [==============================] - 24s 25ms/step - loss: 4.8562e-04 - accuracy: 0.9999 - val_loss: 0.2195 - val_accuracy: 0.9912
Epoch 95/100
938/938 [==============================] - 23s 24ms/step - loss: 9.2438e-04 - accuracy: 0.9999 - val_loss: 0.2121 - val_accuracy: 0.9921
Epoch 96/100
938/938 [==============================] - 24s 26ms/step - loss: 0.0014 - accuracy: 0.9998 - val_loss: 0.1870 - val_accuracy: 0.9925
Epoch 97/100
938/938 [==============================] - 25s 26ms/step - loss: 0.0017 - accuracy: 0.9998 - val_loss: 0.1982 - val_accuracy: 0.9923
Epoch 98/100
938/938 [==============================] - 24s 26ms/step - loss: 5.6121e-04 - accuracy: 0.9999 - val_loss: 0.2453 - val_accuracy: 0.9911
Epoch 99/100
938/938 [==============================] - 23s 25ms/step - loss: 0.0010 - accuracy: 0.9998 - val_loss: 0.2060 - val_accuracy: 0.9926
Epoch 100/100
938/938 [==============================] - 23s 25ms/step - loss: 5.7962e-04 - accuracy: 0.9999 - val_loss: 0.2604 - val_accuracy: 0.9916

/Users/sbecker11/workspace-angel/tuttle-twins-image-classification
>